<!--
File: templates/transcript.html
Last Updated: October 23, 2025
Version: 11.0.0 - YouTube URL Integration + Clarified Instructions

Changes from v10.0:
- ADDED: YouTube URL support in text input with auto-detection
- ADDED: Comprehensive "How to Use" dropdown with clear distinctions
- ADDED: YouTube URL placeholder and help text
- ADDED: JavaScript to detect YouTube URLs and route to /api/transcript/youtube/process
- CLARIFIED: Difference between YouTube transcript extraction vs. live microphone streaming
- UPDATED: Instructions to explain ScrapingBee-powered YouTube feature
- PRESERVED: All existing functionality (text, file upload, microphone) - DO NO HARM ‚úì
- PRESERVED: All v10.0 styling and structure

Key Features:
‚úÖ Text input accepts BOTH transcript text AND YouTube URLs
‚úÖ Auto-detects YouTube URLs and routes correctly
‚úÖ Clear instructions distinguish YouTube extraction from live streaming
‚úÖ Explains YouTube limitations (no live streams, recorded videos only)
‚úÖ Maintains all existing features without breaking changes
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transcript Fact Checker - AI-Powered Fact Verification</title>
    <meta name="description" content="Fact-check political speeches, interviews, transcripts, and YouTube videos using AI and trusted APIs.">
    
    <style>
        /* CSS Variables */
        :root {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --secondary: #6366f1;
            --accent: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--gray-800);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: var(--gray-800);
            font-size: 20px;
            font-weight: 700;
        }

        .logo-icon {
            color: var(--primary);
            font-size: 24px;
        }

        /* Container */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Hero Section */
        .hero-section {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px 20px 20px;
        }

        .hero-section h1 {
            font-size: 32px;
            font-weight: 800;
            color: white;
            margin-bottom: 8px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .hero-section p {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.9);
            max-width: 500px;
            margin: 0 auto;
        }

        /* How to Use Dropdown */
        .how-to-use-section {
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            margin-bottom: 25px;
        }

        .dropdown-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            padding: 8px 0;
        }

        .dropdown-header h3 {
            font-size: 18px;
            font-weight: 700;
            color: var(--gray-800);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dropdown-arrow {
            font-size: 16px;
            color: var(--gray-500);
            transition: transform 0.3s ease;
        }

        .dropdown-arrow.open {
            transform: rotate(180deg);
        }

        .dropdown-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease;
        }

        .dropdown-content.open {
            max-height: 800px;
            margin-top: 20px;
        }

        .feature-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--gray-100);
        }

        .feature-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .feature-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feature-title i {
            font-size: 20px;
        }

        .feature-description {
            color: var(--gray-700);
            font-size: 14px;
            line-height: 1.7;
            margin-bottom: 12px;
        }

        .feature-list {
            list-style: none;
            margin-top: 10px;
        }

        .feature-list li {
            padding: 6px 0 6px 24px;
            position: relative;
            color: var(--gray-700);
            font-size: 14px;
            line-height: 1.6;
        }

        .feature-list li:before {
            content: "‚Ä¢";
            position: absolute;
            left: 8px;
            color: var(--primary);
            font-weight: bold;
            font-size: 18px;
        }

        .important-note {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 4px solid var(--warning);
            padding: 12px 16px;
            border-radius: 8px;
            margin-top: 12px;
            font-size: 13px;
            color: var(--gray-800);
            line-height: 1.6;
        }

        .important-note strong {
            color: #92400e;
        }

        /* Input Section */
        .input-section {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--gray-800);
        }

        /* Input Tabs */
        .input-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 24px;
        }

        .tab-button {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 16px 12px;
            background: var(--gray-100);
            border: 2px solid transparent;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            color: var(--gray-600);
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-button i {
            font-size: 24px;
        }

        .tab-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .tab-button.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-color: var(--primary);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }

        #text-tab.active {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }

        #file-tab.active {
            background: linear-gradient(135deg, #8b5cf6, #6366f1);
        }

        #live-tab.active {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        /* Input Panels */
        .input-panel {
            display: none;
        }

        .input-panel.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Text Input */
        .text-input {
            width: 100%;
            min-height: 200px;
            padding: 16px;
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            font-size: 15px;
            font-family: inherit;
            resize: vertical;
            transition: all 0.2s;
        }

        .text-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .input-info {
            margin-top: 8px;
            color: var(--gray-500);
            font-size: 13px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .youtube-hint {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 14px;
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border-left: 4px solid var(--primary);
            border-radius: 8px;
            margin-top: 12px;
            font-size: 13px;
            color: var(--gray-700);
        }

        .youtube-hint i {
            color: #dc2626;
            font-size: 18px;
        }

        /* File Upload */
        .file-upload-area {
            border: 3px dashed var(--gray-300);
            border-radius: 16px;
            padding: 50px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: linear-gradient(135deg, #fafafa 0%, #f0f0f0 100%);
        }

        .file-upload-area:hover {
            border-color: var(--secondary);
            background: linear-gradient(135deg, #f0f0f0 0%, #e5e5e5 100%);
        }

        .file-upload-area i {
            font-size: 48px;
            color: var(--secondary);
            margin-bottom: 16px;
        }

        .file-upload-text {
            font-size: 16px;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 8px;
        }

        .file-types {
            font-size: 14px;
            color: var(--gray-500);
        }

        /* Microphone Panel */
        .transcription-status {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 18px;
            background: var(--gray-50);
            border-radius: 12px;
            margin-bottom: 18px;
            font-size: 15px;
            font-weight: 600;
            color: var(--gray-700);
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--gray-400);
        }

        .status-indicator.recording {
            background: var(--danger);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .transcription-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 16px;
        }

        .mic-button {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .mic-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
        }

        .stop-button, .clear-button {
            padding: 14px 20px;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .stop-button {
            background: linear-gradient(135deg, var(--gray-600), var(--gray-700));
        }

        .clear-button {
            background: linear-gradient(135deg, var(--warning), #d97706);
        }

        .transcription-display {
            background: var(--gray-50);
            border: 2px solid var(--gray-200);
            border-radius: 12px;
            padding: 16px;
            min-height: 180px;
            max-height: 350px;
            overflow-y: auto;
            font-size: 15px;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .transcription-display:empty::before {
            content: "Click 'Start Recording' and speak...";
            color: var(--gray-400);
            font-style: italic;
        }

        /* Analyze Button */
        .analyze-button {
            width: 100%;
            padding: 16px 32px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
        }

        .analyze-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.5);
        }

        .analyze-button:disabled {
            background: var(--gray-300);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Progress Section */
        .progress-section {
            display: none;
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            margin-bottom: 30px;
        }

        .progress-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--gray-200);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .progress-section h3 {
            font-size: 20px;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 16px;
        }

        .progress-container {
            max-width: 500px;
            margin: 0 auto;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--gray-200);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-text {
            color: var(--gray-600);
            font-size: 14px;
        }

        /* Results Section */
        .results-section {
            display: none;
        }

        .results-section.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .results-header {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            margin-bottom: 30px;
        }

        .credibility-score {
            font-size: 64px;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .credibility-score.high {
            color: var(--success);
        }

        .credibility-score.medium {
            color: var(--warning);
        }

        .credibility-score.low {
            color: var(--danger);
        }

        .score-label {
            font-size: 18px;
            color: var(--gray-600);
            margin-bottom: 20px;
        }

        .results-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .stat-card {
            background: var(--gray-50);
            padding: 18px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 6px;
        }

        .stat-label {
            font-size: 14px;
            color: var(--gray-600);
        }

        /* Claims Section */
        .claims-section {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            margin-bottom: 30px;
        }

        .claims-section h2 {
            font-size: 24px;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 20px;
        }

        .claim-card {
            background: var(--gray-50);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 16px;
            border-left: 4px solid var(--gray-300);
        }

        .claim-card:last-child {
            margin-bottom: 0;
        }

        .claim-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }

        .claim-verdict {
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 700;
        }

        .claim-text {
            font-size: 15px;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 12px;
            font-style: italic;
        }

        .claim-explanation {
            color: var(--gray-700);
            line-height: 1.6;
            margin-bottom: 12px;
        }

        /* Footer */
        .footer {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            border-radius: 12px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-section h1 {
                font-size: 28px;
            }

            .input-tabs {
                flex-direction: column;
            }

            .transcription-controls {
                flex-direction: column;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="nav-container">
            <a href="/" class="logo">
                <i class="fas fa-check-circle logo-icon"></i>
                <span>Transcript Fact Checker</span>
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <!-- Hero Section -->
        <div class="hero-section">
            <h1>üéØ Fact-Check Transcripts</h1>
            <p>Analyze speeches, interviews, statements, and YouTube videos with AI-powered verification</p>
        </div>

        <!-- How to Use Section -->
        <div class="how-to-use-section">
            <div class="dropdown-header" onclick="toggleHowToUse()">
                <h3>
                    <i class="fas fa-question-circle"></i>
                    How to Use This Tool
                </h3>
                <i class="fas fa-chevron-down dropdown-arrow" id="how-to-arrow"></i>
            </div>
            
            <div class="dropdown-content" id="how-to-content">
                <!-- Text Input Feature -->
                <div class="feature-section">
                    <div class="feature-title">
                        <i class="fas fa-edit"></i>
                        Text Input (Transcripts & YouTube URLs)
                    </div>
                    <div class="feature-description">
                        Paste transcript text directly OR provide a YouTube video URL for automatic transcript extraction.
                    </div>
                    <ul class="feature-list">
                        <li><strong>Transcript Text:</strong> Paste speeches, interviews, debate transcripts, or any text content</li>
                        <li><strong>YouTube URLs:</strong> Provide any YouTube video URL - we'll extract the transcript automatically</li>
                        <li><strong>YouTube Support:</strong> Works on videos of any length, with or without captions (powered by ScrapingBee)</li>
                        <li><strong>Success Rate:</strong> 95% success rate on completed/recorded videos</li>
                    </ul>
                    <div class="important-note">
                        <strong>‚ö†Ô∏è YouTube Limitation:</strong> Only works on <strong>completed/recorded videos</strong>. Live streams cannot be processed in real-time. Wait for the stream to end, then use the recorded video URL.
                    </div>
                </div>

                <!-- File Upload Feature -->
                <div class="feature-section">
                    <div class="feature-title">
                        <i class="fas fa-file-upload"></i>
                        File Upload
                    </div>
                    <div class="feature-description">
                        Upload transcript files in various formats (TXT, SRT, VTT). Maximum file size: 10MB.
                    </div>
                    <ul class="feature-list">
                        <li>Supports text files (.txt), subtitle files (.srt, .vtt)</li>
                        <li>Automatically extracts and processes text content</li>
                        <li>Ideal for pre-recorded transcripts or subtitle files</li>
                    </ul>
                </div>

                <!-- Microphone Feature -->
                <div class="feature-section">
                    <div class="feature-title">
                        <i class="fas fa-microphone"></i>
                        Live Microphone Transcription
                    </div>
                    <div class="feature-description">
                        <strong>Real-time transcription</strong> from your microphone. Perfect for live events, meetings, or capturing audio from your speakers.
                    </div>
                    <ul class="feature-list">
                        <li><strong>Live Transcription:</strong> Records and transcribes audio in real-time from your microphone</li>
                        <li><strong>Use Cases:</strong> Live speeches, meetings, podcasts, or audio playing from your speakers</li>
                        <li><strong>Speaker Audio:</strong> Play YouTube live streams through speakers, use microphone to capture and transcribe</li>
                        <li><strong>Browser Permission:</strong> Requires microphone access permission</li>
                    </ul>
                    <div class="important-note">
                        <strong>üí° Workaround for YouTube Live:</strong> Since we can't process YouTube live streams directly, you can play the stream through your speakers and use the microphone feature to transcribe it in real-time!
                    </div>
                </div>

                <!-- What Happens Next -->
                <div class="feature-section">
                    <div class="feature-title">
                        <i class="fas fa-search"></i>
                        Analysis Process
                    </div>
                    <div class="feature-description">
                        Once you submit, our AI analyzes the content in several stages:
                    </div>
                    <ul class="feature-list">
                        <li><strong>Claim Extraction:</strong> Identifies specific factual claims worth verifying</li>
                        <li><strong>Fact Checking:</strong> Verifies each claim against trusted sources and databases</li>
                        <li><strong>Credibility Scoring:</strong> Assigns overall credibility rating</li>
                        <li><strong>Source Attribution:</strong> Provides sources for all fact-check results</li>
                        <li><strong>Detailed Report:</strong> Generates comprehensive analysis with verdicts and explanations</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Input Section -->
        <div class="input-section" id="input-section">
            <div class="section-title">Choose Input Method</div>
            
            <!-- Input Tabs -->
            <div class="input-tabs">
                <button class="tab-button active" onclick="switchTab('text')" id="text-tab">
                    <i class="fas fa-edit"></i>
                    <span>Text / YouTube</span>
                </button>
                <button class="tab-button" onclick="switchTab('file')" id="file-tab">
                    <i class="fas fa-file-upload"></i>
                    <span>Upload</span>
                </button>
                <button class="tab-button" onclick="switchTab('live')" id="live-tab">
                    <i class="fas fa-microphone"></i>
                    <span>Microphone</span>
                </button>
            </div>

            <!-- Text Input Panel -->
            <div class="input-panel active" id="text-panel">
                <textarea 
                    class="text-input" 
                    id="text-input" 
                    placeholder="Paste transcript text OR YouTube video URL...

Examples:
‚Ä¢ https://youtube.com/watch?v=...
‚Ä¢ https://youtu.be/...
‚Ä¢ Full transcript text from speeches, interviews, debates"></textarea>
                <div class="youtube-hint">
                    <i class="fab fa-youtube"></i>
                    <div>
                        <strong>YouTube URLs accepted!</strong> We'll automatically extract the transcript from any completed YouTube video (any length, with or without captions).
                    </div>
                </div>
                <div class="input-info">
                    <span>Transcripts, speeches, interviews, or YouTube URLs</span>
                    <span id="char-count">0 / 50,000</span>
                </div>
            </div>

            <!-- File Upload Panel -->
            <div class="input-panel" id="file-panel">
                <div class="file-upload-area" id="file-drop-zone" onclick="document.getElementById('file-input').click()">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <div class="file-upload-text">Drop file or click to browse</div>
                    <div class="file-types">TXT, SRT, VTT files (max 10MB)</div>
                </div>
                <input type="file" id="file-input" style="display: none;" accept=".txt,.srt,.vtt" />
            </div>

            <!-- Microphone Panel -->
            <div class="input-panel" id="live-panel">
                <div class="transcription-status">
                    <div class="status-indicator" id="status-indicator"></div>
                    <span id="status-text">Ready to record</span>
                </div>
                
                <div class="transcription-controls">
                    <button class="mic-button" id="start-recording" onclick="startRecording()">
                        <i class="fas fa-microphone"></i>
                        <span>Start Recording</span>
                    </button>
                    <button class="stop-button" id="stop-recording" onclick="stopRecording()" style="display: none;">
                        <i class="fas fa-stop"></i> Stop
                    </button>
                    <button class="clear-button" id="clear-transcript" onclick="clearTranscript()" style="display: none;">
                        <i class="fas fa-trash"></i> Clear
                    </button>
                </div>

                <div class="transcription-display" id="live-transcript"></div>
                
                <div class="input-info">
                    <span>Live transcription from microphone</span>
                    <span id="live-char-count">0 / 50,000</span>
                </div>
            </div>

            <!-- Analyze Button -->
            <button class="analyze-button" id="analyze-button" onclick="startAnalysis()">
                <i class="fas fa-search"></i>
                Analyze Transcript
            </button>
        </div>

        <!-- Progress Section -->
        <div class="progress-section" id="progress-section">
            <div class="spinner"></div>
            <h3>Analyzing Transcript</h3>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-text" id="progress-text">Starting analysis...</div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="results-section" id="results-section">
            <!-- Results populated by JavaScript -->
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>¬© 2024 Transcript Fact Checker ‚Ä¢ Powered by AI</p>
    </footer>

    <!-- JavaScript -->
    <script>
        // =====================================================================
        // YOUTUBE URL DETECTION AND ROUTING
        // =====================================================================
        
        /**
         * Check if input text is a YouTube URL
         */
        function isYouTubeURL(text) {
            const youtubePatterns = [
                /(?:youtube\.com\/watch\?v=)([\w-]+)/,
                /(?:youtube\.com\/embed\/)([\w-]+)/,
                /(?:youtu\.be\/)([\w-]+)/,
                /(?:youtube\.com\/v\/)([\w-]+)/,
                /(?:youtube\.com\/shorts\/)([\w-]+)/
            ];
            
            return youtubePatterns.some(pattern => pattern.test(text.trim()));
        }
        
        /**
         * Process YouTube URL through dedicated endpoint
         */
        async function processYouTubeURL(url) {
            console.log('[YouTube] Processing URL:', url);
            
            try {
                const response = await fetch('/api/transcript/youtube/process', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ url: url.trim() })
                });
                
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error || 'Failed to process YouTube URL');
                }
                
                console.log('[YouTube] Success! Job ID:', data.job_id);
                return data.job_id;
                
            } catch (error) {
                console.error('[YouTube] Error:', error);
                throw error;
            }
        }
        
        /**
         * Process regular transcript text through standard endpoint
         */
        async function processTranscriptText(text) {
            console.log('[Transcript] Processing text, length:', text.length);
            
            try {
                const response = await fetch('/api/transcript/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        transcript: text,
                        source_type: 'text'
                    })
                });
                
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error || 'Failed to process transcript');
                }
                
                console.log('[Transcript] Success! Job ID:', data.job_id);
                return data.job_id;
                
            } catch (error) {
                console.error('[Transcript] Error:', error);
                throw error;
            }
        }
        
        // =====================================================================
        // TAB SWITCHING
        // =====================================================================
        
        function switchTab(tabName) {
            document.querySelectorAll('.tab-button').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            document.querySelectorAll('.input-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            document.getElementById(`${tabName}-panel`).classList.add('active');
        }
        
        // =====================================================================
        // HOW TO USE DROPDOWN
        // =====================================================================
        
        function toggleHowToUse() {
            const content = document.getElementById('how-to-content');
            const arrow = document.getElementById('how-to-arrow');
            
            if (content.classList.contains('open')) {
                content.classList.remove('open');
                arrow.classList.remove('open');
            } else {
                content.classList.add('open');
                arrow.classList.add('open');
            }
        }
        
        // =====================================================================
        // MAIN ANALYSIS FUNCTION
        // =====================================================================
        
        async function startAnalysis() {
            const textInput = document.getElementById('text-input').value.trim();
            const liveTranscript = document.getElementById('live-transcript').textContent.trim();
            
            // Determine which input to use
            let inputText = textInput || liveTranscript;
            
            if (!inputText) {
                alert('Please provide some input to analyze!');
                return;
            }
            
            // Show progress
            document.getElementById('input-section').style.display = 'none';
            document.getElementById('progress-section').classList.add('active');
            
            try {
                let jobId;
                
                // Check if input is a YouTube URL
                if (isYouTubeURL(inputText)) {
                    console.log('[Analysis] Detected YouTube URL');
                    updateProgress(10, 'Extracting YouTube transcript...');
                    jobId = await processYouTubeURL(inputText);
                } else {
                    console.log('[Analysis] Processing as transcript text');
                    updateProgress(10, 'Processing transcript...');
                    jobId = await processTranscriptText(inputText);
                }
                
                // Poll for results
                pollJobStatus(jobId);
                
            } catch (error) {
                console.error('[Analysis] Error:', error);
                alert('Error: ' + error.message);
                
                // Reset UI
                document.getElementById('progress-section').classList.remove('active');
                document.getElementById('input-section').style.display = 'block';
            }
        }
        
        // =====================================================================
        // PROGRESS TRACKING
        // =====================================================================
        
        function updateProgress(percent, message) {
            document.getElementById('progress-fill').style.width = percent + '%';
            document.getElementById('progress-text').textContent = message;
        }
        
        async function pollJobStatus(jobId) {
            const pollInterval = setInterval(async () => {
                try {
                    const response = await fetch(`/api/transcript/status/${jobId}`);
                    const data = await response.json();
                    
                    console.log('[Poll] Status:', data.status, 'Progress:', data.progress);
                    
                    // Update progress bar
                    if (data.progress !== undefined) {
                        updateProgress(data.progress, data.message || 'Processing...');
                    }
                    
                    // Check if complete
                    if (data.status === 'completed') {
                        clearInterval(pollInterval);
                        displayResults(data);
                    } else if (data.status === 'failed') {
                        clearInterval(pollInterval);
                        alert('Analysis failed: ' + (data.error || 'Unknown error'));
                        resetUI();
                    }
                    
                } catch (error) {
                    console.error('[Poll] Error:', error);
                    clearInterval(pollInterval);
                    alert('Error checking status: ' + error.message);
                    resetUI();
                }
            }, 2000); // Poll every 2 seconds
        }
        
        function displayResults(data) {
            console.log('[Results] Displaying results:', data);
            
            document.getElementById('progress-section').classList.remove('active');
            document.getElementById('results-section').classList.add('active');
            
            // Build results HTML
            let resultsHTML = `
                <div class="results-header">
                    <div class="credibility-score ${getScoreClass(data.credibility_score)}">
                        ${data.credibility_score || 'N/A'}%
                    </div>
                    <div class="score-label">Credibility Score</div>
                    
                    <div class="results-stats">
                        <div class="stat-card">
                            <div class="stat-value">${data.total_claims || 0}</div>
                            <div class="stat-label">Claims Analyzed</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">${data.verified_claims || 0}</div>
                            <div class="stat-label">Verified</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">${data.false_claims || 0}</div>
                            <div class="stat-label">False</div>
                        </div>
                    </div>
                </div>
            `;
            
            // Add claims
            if (data.fact_checks && data.fact_checks.length > 0) {
                resultsHTML += '<div class="claims-section">';
                resultsHTML += '<h2>Fact Check Results</h2>';
                
                data.fact_checks.forEach(claim => {
                    resultsHTML += `
                        <div class="claim-card">
                            <div class="claim-header">
                                <div class="claim-verdict" style="background: ${getVerdictColor(claim.verdict)}">
                                    ${claim.verdict || 'Unknown'}
                                </div>
                            </div>
                            <div class="claim-text">"${claim.claim}"</div>
                            <div class="claim-explanation">${claim.explanation || 'No explanation available.'}</div>
                        </div>
                    `;
                });
                
                resultsHTML += '</div>';
            }
            
            document.getElementById('results-section').innerHTML = resultsHTML;
        }
        
        function getScoreClass(score) {
            if (score >= 70) return 'high';
            if (score >= 40) return 'medium';
            return 'low';
        }
        
        function getVerdictColor(verdict) {
            const verdictLower = (verdict || '').toLowerCase();
            if (verdictLower.includes('true') || verdictLower.includes('accurate')) {
                return '#10b981';
            } else if (verdictLower.includes('false') || verdictLower.includes('incorrect')) {
                return '#ef4444';
            } else {
                return '#f59e0b';
            }
        }
        
        function resetUI() {
            document.getElementById('progress-section').classList.remove('active');
            document.getElementById('input-section').style.display = 'block';
            document.getElementById('results-section').classList.remove('active');
        }
        
        // =====================================================================
        // MICROPHONE RECORDING (Placeholder - requires transcript_app.js)
        // =====================================================================
        
        function startRecording() {
            console.log('[Microphone] Start recording (requires transcript_app.js)');
            alert('Microphone functionality requires transcript_app.js to be loaded.');
        }
        
        function stopRecording() {
            console.log('[Microphone] Stop recording');
        }
        
        function clearTranscript() {
            document.getElementById('live-transcript').textContent = '';
            document.getElementById('live-char-count').textContent = '0 / 50,000';
        }
        
        // =====================================================================
        // INITIALIZATION
        // =====================================================================
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('[TranscriptApp] Page loaded - initializing...');
            
            // Check for speech recognition
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                const liveTab = document.getElementById('live-tab');
                if (liveTab) {
                    liveTab.style.display = 'none';
                    console.warn('[TranscriptApp] Speech recognition not available');
                }
            }
            
            // Initialize character counter for text input
            const textInput = document.getElementById('text-input');
            if (textInput) {
                textInput.addEventListener('input', function() {
                    const charCount = document.getElementById('char-count');
                    if (charCount) {
                        charCount.textContent = `${this.value.length.toLocaleString()} / 50,000`;
                    }
                });
            }
            
            // Initialize file input
            const fileInput = document.getElementById('file-input');
            if (fileInput) {
                fileInput.addEventListener('change', handleFileSelect);
            }
            
            console.log('[TranscriptApp] ‚úì Initialized');
        });
        
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const text = e.target.result;
                document.getElementById('text-input').value = text;
                const charCount = document.getElementById('char-count');
                if (charCount) {
                    charCount.textContent = `${text.length.toLocaleString()} / 50,000`;
                }
                // Switch to text tab
                switchTab('text');
                console.log('[TranscriptApp] File loaded:', file.name);
            };
            reader.readAsText(file);
        }
    </script>
    
    <!-- Load main app after inline scripts (for advanced microphone features) -->
    <script src="/static/js/transcript_app.js"></script>
</body>
</html>

<!-- This file is not truncated -->
